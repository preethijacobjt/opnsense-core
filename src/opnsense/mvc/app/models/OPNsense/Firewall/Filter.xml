<model>
    <mount>//OPNsense/Firewall/Filter</mount>
    <version>1.0.6</version>
    <migration_prefix>MFP</migration_prefix>
    <description>OPNsense firewall filter rules</description>
    <items>
        <rules>
            <rule type=".\FilterRuleField">
                <enabled type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </enabled>
                <statetype type="OptionField">
                    <Required>Y</Required>
                    <Default>keep</Default>
                    <OptionValues>
                        <keep>keep state</keep>
                        <sloppy>sloppy state</sloppy>
                        <modulate>modulate state</modulate>
                        <synproxy>synproxy state</synproxy>
                        <none>no state</none>
                    </OptionValues>
                </statetype>
                <state-policy type="OptionField">
                    <BlankDesc>default</BlankDesc>
                    <OptionValues>
                        <if-bound>Bind states to interface</if-bound>
                        <floating>Floating states</floating>
                    </OptionValues>
                </state-policy>
                <sequence type=".\FilterSequenceField">
                    <MinimumValue>1</MinimumValue>
                    <MaximumValue>999999</MaximumValue>
                    <ValidationMessage>Sequence shall be between 1 and 999999.</ValidationMessage>
                    <Required>Y</Required>
                    <Default>1</Default>
                </sequence>
                <sort_order type="TextField" volatile="true"/>
                <prio_group type="TextField" volatile="true"/>
                <action type="OptionField">
                    <Required>Y</Required>
                    <Default>pass</Default>
                    <OptionValues>
                        <pass>Pass</pass>
                        <block>Block</block>
                        <reject>Reject</reject>
                    </OptionValues>
                </action>
                <quick type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </quick>
                <interfacenot type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </interfacenot>
                <interface type="InterfaceField">
                    <Multiple>Y</Multiple>
                    <Filters>
                        <if>/^(?!lo0$).*/</if>
                    </Filters>
                    <AllowDynamic>Y</AllowDynamic>
                </interface>
                <direction type="OptionField">
                    <Required>Y</Required>
                    <Default>in</Default>
                    <OptionValues>
                        <in>In</in>
                        <out>Out</out>
                    </OptionValues>
                </direction>
                <ipprotocol type="OptionField">
                    <Required>Y</Required>
                    <Default>inet</Default>
                    <OptionValues>
                        <inet>IPv4</inet>
                        <inet6>IPv6</inet6>
                        <inet46>IPv4+IPv6</inet46>
                    </OptionValues>
                </ipprotocol>
                <protocol type="ProtocolField">
                    <Required>Y</Required>
                    <Default>any</Default>
                    <AddOptions>
                        <opt1 value='TCP/UDP'>TCP/UDP</opt1>
                    </AddOptions>
                </protocol>
                <icmptype type="OptionField">
                    <Multiple>Y</Multiple>
                    <OptionValues>
                        <echoreq>Echo Request</echoreq>
                        <echorep>Echo Reply</echorep>
                        <unreach>Destination Unreachable</unreach>
                        <squench>Source Quench (Deprecated)</squench>
                        <redir>Redirect</redir>
                        <althost>Alternate Host Address (Deprecated)</althost>
                        <routeradv>Router Advertisement</routeradv>
                        <routersol>Router Solicitation</routersol>
                        <timex>Time Exceeded</timex>
                        <paramprob>Parameter Problem</paramprob>
                        <timereq>Timestamp</timereq>
                        <timerep>Timestamp Reply</timerep>
                        <inforeq>Information Request (Deprecated)</inforeq>
                        <inforep>Information Reply (Deprecated)</inforep>
                        <maskreq>Address Mask Request (Deprecated)</maskreq>
                        <maskrep>Address Mask Reply (Deprecated)</maskrep>
                    </OptionValues>
                </icmptype>
                <!-- XXX: should map internally to  'source' => array('network' => $source_net, "not" => true|false) -->
                <source_net type="NetworkAliasField">
                    <Default>any</Default>
                    <Required>Y</Required>
                    <Multiple>Y</Multiple>
                </source_net>
                <source_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </source_not>
                <source_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </source_port>
                <!-- XXX: should map internally to  'source' => array('destination' => destination_net, "not" => true|false) -->
                <destination_net type="NetworkAliasField">
                    <Default>any</Default>
                    <Required>Y</Required>
                    <Multiple>Y</Multiple>
                </destination_net>
                <destination_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </destination_not>
                <destination_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </destination_port>
                <gateway type="JsonKeyValueStoreField">
                    <ConfigdPopulateAct>interface gateways list -g</ConfigdPopulateAct>
                    <ValidationMessage>Specify a valid gateway from the list matching the networks ip protocol.</ValidationMessage>
                </gateway>
                <replyto  type="JsonKeyValueStoreField">
                    <ConfigdPopulateAct>interface gateways list</ConfigdPopulateAct>
                    <ValidationMessage>Specify a valid gateway from the list matching the networks ip protocol.</ValidationMessage>
                </replyto>
                <disablereplyto type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </disablereplyto>
                <log type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </log>
                <allowopts type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </allowopts>
                <nosync type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </nosync>
                <nopfsync type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </nopfsync>
                <statetimeout type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </statetimeout>
                <max-src-nodes type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max-src-nodes>
                <max-src-states type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max-src-states>
                <max-src-conn type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max-src-conn>
                <max type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max>
                <max-src-conn-rate type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max-src-conn-rate>
                <max-src-conn-rates type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max-src-conn-rates>
                <overload  type="ModelRelationField">
                    <Model>
                        <aliases>
                            <source>OPNsense.Firewall.Alias</source>
                            <items>aliases.alias</items>
                            <display>name</display>
                            <filters>
                                <enabled>/^(?!0).*$/</enabled>
                                <type>/^(?!(port)).*$/</type>
                            </filters>
                        </aliases>
                    </Model>
                    <ValidationMessage>Alias not found.</ValidationMessage>
                </overload>
                <adaptivestart type="IntegerField">
                    <MinimumValue>0</MinimumValue>
                </adaptivestart>
                <adaptiveend type="IntegerField">
                    <MinimumValue>0</MinimumValue>
                </adaptiveend>
                <prio type="OptionField">
                    <BlankDesc>Any priority</BlankDesc>
                    <OptionValues>
                        <opt1 value="1">Background (1, lowest)</opt1>
                        <opt0 value="0">Best Effort (0, default)</opt0>
                        <opt2 value="2">Excellent Effort (2)</opt2>
                        <opt3 value="3">Critical Applications (3)</opt3>
                        <opt4 value="4">Video (4)</opt4>
                        <opt5 value="5">Voice (5)</opt5>
                        <opt6 value="6">Internetwork Control (6)</opt6>
                        <opt7 value="7">Network Control (7, highest)</opt7>
                    </OptionValues>
                </prio>
                <set-prio type="OptionField">
                    <BlankDesc>Keep current priority</BlankDesc>
                    <OptionValues>
                        <opt1 value="1">Background (1, lowest)</opt1>
                        <opt0 value="0">Best Effort (0, default)</opt0>
                        <opt2 value="2">Excellent Effort (2)</opt2>
                        <opt3 value="3">Critical Applications (3)</opt3>
                        <opt4 value="4">Video (4)</opt4>
                        <opt5 value="5">Voice (5)</opt5>
                        <opt6 value="6">Internetwork Control (6)</opt6>
                        <opt7 value="7">Network Control (7, highest)</opt7>
                    </OptionValues>
                </set-prio>
                <set-prio-low type="OptionField">
                    <BlankDesc>Keep current priority</BlankDesc>
                    <OptionValues>
                        <opt1 value="1">Background (1, lowest)</opt1>
                        <opt0 value="0">Best Effort (0, default)</opt0>
                        <opt2 value="2">Excellent Effort (2)</opt2>
                        <opt3 value="3">Critical Applications (3)</opt3>
                        <opt4 value="4">Video (4)</opt4>
                        <opt5 value="5">Voice (5)</opt5>
                        <opt6 value="6">Internetwork Control (6)</opt6>
                        <opt7 value="7">Network Control (7, highest)</opt7>
                    </OptionValues>
                </set-prio-low>
                <tag type="TextField">
                    <Mask>/^([0-9a-zA-Z.,_\-]){0,512}$/u</Mask>
                </tag>
                <tagged type="TextField">
                    <Mask>/^([0-9a-zA-Z.,_\-]){0,512}$/u</Mask>
                </tagged>
                <tcpflags1 type="OptionField">
                    <Multiple>Y</Multiple>
                    <OptionValues>
                        <syn>syn</syn>
                        <ack>ack</ack>
                        <fin>fin</fin>
                        <rst>rst</rst>
                        <psh>psh</psh>
                        <urg>urg</urg>
                        <ece>ece</ece>
                        <cwr>cwr</cwr>
                    </OptionValues>
                </tcpflags1>
                <tcpflags2 type="OptionField">
                    <Multiple>Y</Multiple>
                    <OptionValues>
                        <syn>syn</syn>
                        <ack>ack</ack>
                        <fin>fin</fin>
                        <rst>rst</rst>
                        <psh>psh</psh>
                        <urg>urg</urg>
                        <ece>ece</ece>
                        <cwr>cwr</cwr>
                    </OptionValues>
                </tcpflags2>
                <categories type="ModelRelationField">
                    <Model>
                        <rulesets>
                            <source>OPNsense.Firewall.Category</source>
                            <items>categories.category</items>
                            <display>name</display>
                        </rulesets>
                    </Model>
                    <Multiple>Y</Multiple>
                    <ValidationMessage>Related category not found.</ValidationMessage>
                </categories>
                <sched type=".\ScheduleField"/>
                <tos type=".\TosField"/>
                <shaper1 type="ModelRelationField">
                    <Model>
                        <pipes>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>pipes.pipe</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </pipes>
                        <queues>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>queues.queue</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </queues>
                    </Model>
                    <ValidationMessage>Related pipe or queue not found</ValidationMessage>
                </shaper1>
                <shaper2 type="ModelRelationField">
                    <Model>
                        <pipes>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>pipes.pipe</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </pipes>
                        <queues>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>queues.queue</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </queues>
                    </Model>
                    <ValidationMessage>Related pipe or queue not found</ValidationMessage>
                </shaper2>
                <description type="DescriptionField"/>
            </rule>
        </rules>
        <snatrules>
            <rule type=".\SourceNatRuleField">
                <enabled type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </enabled>
                <nonat type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </nonat>
                <sequence type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                    <MaximumValue>99999</MaximumValue>
                    <ValidationMessage>provide a valid sequence for sorting</ValidationMessage>
                    <Required>Y</Required>
                    <Default>1</Default>
                </sequence>
                <interface type="InterfaceField">
                    <Required>Y</Required>
                    <Default>lan</Default>
                    <Filters>
                        <if>/^(?!lo0$).*/</if>
                    </Filters>
                    <AllowDynamic>Y</AllowDynamic>
                </interface>
                <ipprotocol type="OptionField">
                    <Required>Y</Required>
                    <Default>inet</Default>
                    <OptionValues>
                        <inet>IPv4</inet>
                        <inet6>IPv6</inet6>
                    </OptionValues>
                </ipprotocol>
                <protocol type="ProtocolField">
                    <Required>Y</Required>
                    <Default>any</Default>
                    <AddOptions>
                        <opt1 value='TCP/UDP'>TCP/UDP</opt1>
                    </AddOptions>
                </protocol>
                <source_net type="NetworkAliasField">
                    <Default>any</Default>
                    <Required>Y</Required>
                </source_net>
                <source_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </source_not>
                <source_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </source_port>
                <destination_net type="NetworkAliasField">
                    <Default>any</Default>
                    <Required>Y</Required>
                </destination_net>
                <destination_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </destination_not>
                <destination_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </destination_port>
                <target type="NetworkAliasField">
                    <Default>wanip</Default>
                    <Required>Y</Required>
                </target>
                <target_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                </target_port>
                <log type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </log>
                <categories type="ModelRelationField">
                    <Model>
                        <rulesets>
                            <source>OPNsense.Firewall.Category</source>
                            <items>categories.category</items>
                            <display>name</display>
                        </rulesets>
                    </Model>
                    <Multiple>Y</Multiple>
                    <ValidationMessage>Related category not found.</ValidationMessage>
                </categories>
                <description type="DescriptionField"/>
            </rule>
        </snatrules>
        <npt>
            <rule type=".\SourceNatRuleField">
                <enabled type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </enabled>
                <log type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </log>
                <sequence type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                    <MaximumValue>99999</MaximumValue>
                    <ValidationMessage>provide a valid sequence for sorting</ValidationMessage>
                    <Required>Y</Required>
                    <Default>1</Default>
                </sequence>
                <interface type="InterfaceField">
                    <Required>Y</Required>
                    <Default>lan</Default>
                    <Filters>
                        <if>/^(?!lo0$).*/</if>
                    </Filters>
                    <AllowDynamic>Y</AllowDynamic>
                </interface>
                <source_net type="NetworkField">
                    <Required>Y</Required>
                    <AddressFamily>ipv6</AddressFamily>
                    <NetMaskRequired>N</NetMaskRequired>
                    <WildcardEnabled>N</WildcardEnabled>
                </source_net>
                <destination_net type="NetworkField">
                    <AddressFamily>ipv6</AddressFamily>
                    <NetMaskRequired>N</NetMaskRequired>
                    <WildcardEnabled>N</WildcardEnabled>
                </destination_net>
                <trackif type="InterfaceField">
                </trackif>
                <categories type="ModelRelationField">
                    <Model>
                        <rulesets>
                            <source>OPNsense.Firewall.Category</source>
                            <items>categories.category</items>
                            <display>name</display>
                        </rulesets>
                    </Model>
                    <Multiple>Y</Multiple>
                    <ValidationMessage>Related category not found.</ValidationMessage>
                </categories>
                <description type="DescriptionField"/>
            </rule>
        </npt>
        <onetoone>
            <rule type=".\SourceNatRuleField">
                <enabled type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </enabled>
                <log type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </log>
                <sequence type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                    <MaximumValue>99999</MaximumValue>
                    <ValidationMessage>provide a valid sequence for sorting</ValidationMessage>
                    <Required>Y</Required>
                    <Default>1</Default>
                </sequence>
                <interface type="InterfaceField">
                    <Required>Y</Required>
                    <Default>wan</Default>
                    <Filters>
                        <if>/^(?!lo0$).*/</if>
                    </Filters>
                    <AllowDynamic>Y</AllowDynamic>
                </interface>
                <type type="OptionField">
                    <Default>binat</Default>
                    <Required>Y</Required>
                    <OptionValues>
                        <binat>BINAT</binat>
                        <nat>NAT</nat>
                    </OptionValues>
                </type>
                <source_net type="NetworkAliasField">
                    <Required>Y</Required>
                </source_net>
                <source_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </source_not>
                <destination_net type="NetworkAliasField">
                    <Required>Y</Required>
                    <Default>any</Default>
                </destination_net>
                <destination_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </destination_not>
                <external type="NetworkField">
                    <Required>Y</Required>
                    <WildcardEnabled>N</WildcardEnabled>
                </external>
                <natreflection type="OptionField">
                    <OptionValues>
                        <default value="">Default</default>
                        <enable>Enable</enable>
                        <disable>Disable</disable>
                    </OptionValues>
                </natreflection>
                <categories type="ModelRelationField">
                    <Model>
                        <rulesets>
                            <source>OPNsense.Firewall.Category</source>
                            <items>categories.category</items>
                            <display>name</display>
                        </rulesets>
                    </Model>
                    <Multiple>Y</Multiple>
                    <ValidationMessage>Related category not found.</ValidationMessage>
                </categories>
                <description type="DescriptionField"/>
            </rule>
        </onetoone>
        <portforward>
            <rule type=".\SourceNatRuleField"> 
                <enabled type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </enabled>
                <sequence type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                    <MaximumValue>99999</MaximumValue>
                    <ValidationMessage>provide a valid sequence for sorting</ValidationMessage>
                    <Required>Y</Required>
                    <Default>1</Default>
                </sequence>
                <nordr type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </nordr>
                <interface type="InterfaceField">
                    <Required>Y</Required>
                    <Default>wan</Default>
                    <Multiple>Y</Multiple>
                    <AllowDynamic>Y</AllowDynamic>
                </interface>
                <ipprotocol type="OptionField">
                    <Required>Y</Required>
                    <Default>inet</Default>
                    <OptionValues>
                        <inet>IPv4</inet>
                        <inet6>IPv6</inet6>
                        <inet46>IPv4+IPv6</inet46>
                    </OptionValues>
                </ipprotocol>
                <protocol type="ProtocolField">
                    <Required>Y</Required>
                    <Default>TCP</Default>
                </protocol>              
                <source_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </source_not>
                <source_net type="NetworkAliasField">
                    <Required>Y</Required>
                    <Default>any</Default>
                </source_net>
                <source_port type="PortField">
                    <Default>any</Default>
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </source_port>
                <destination_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </destination_not>
                <destination_net type="NetworkAliasField">
                    <Required>Y</Required>
                </destination_net>
                <destination_port type="PortField">
                    <Default>http</Default>
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </destination_port>
                <target type="NetworkAliasField"/>
                <target_port type="PortField">
                    <Default>http</Default>
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </target_port>
                <pool_options type="OptionField">
                    <BlankDesc>Default</BlankDesc>
                    <OptionValues>
                        <round_robin>Round Robin</round_robin>
                        <rr_sticky_addr>Round Robin with Sticky Address</rr_sticky_addr>
                        <random>Random</random>
                        <ra_sticky_addr>Random with Sticky Address</ra_sticky_addr>
                        <source_hash>Source Hash</source_hash>
                        <bitmask>Bitmask</bitmask>
                    </OptionValues>
                </pool_options>
                <log type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </log>
                <categories type="ModelRelationField">
                    <Model>
                        <rulesets>
                            <source>OPNsense.Firewall.Category</source>
                            <items>categories.category</items>
                            <display>name</display>
                        </rulesets>
                    </Model>
                    <Multiple>Y</Multiple>
                    <ValidationMessage>Related category not found.</ValidationMessage>
                </categories>
                <description type="DescriptionField"/>
                <set_tag type="TextField"/>
                <match_tag type="TextField"/>
                <no_xmlrpc_sync type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </no_xmlrpc_sync>
                <nat_reflection type="OptionField">
                    <OptionValues>
                        <default value="">Use System Default</default>
                        <enable>Enable</enable>
                        <disable>Disable</disable>
                    </OptionValues>
                </nat_reflection>
                <filter_rule type="OptionField">
                    <OptionValues>
                        <none value="">None</none>
                        <add_associated>Add associated filter rule</add_associated>
                        <add_unassociated>Add unassociated filter rule</add_unassociated>
                        <pass>Pass</pass>
                    </OptionValues>
                    <Default>add_associated</Default>
                </filter_rule>
            </rule>
        </portforward>
        <firewallrules>
            <rule type=".\SourceNatRuleField">
                <enabled type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </enabled>
                <sequence type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                    <MaximumValue>99999</MaximumValue>
                    <ValidationMessage>provide a valid sequence for sorting</ValidationMessage>
                    <Required>Y</Required>
                    <Default>1</Default>
                </sequence>
                <action type="OptionField">
                    <Required>Y</Required>
                    <Default>pass</Default>
                    <OptionValues>
                        <pass>Pass</pass>
                        <block>Block</block>
                        <reject>Reject</reject>
                    </OptionValues>
                </action>
                <quick type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </quick>
                <floating type="BooleanField">
                    <Default>0</Default>
                </floating>
                <interface_invert type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </interface_invert>
                <interface type="InterfaceField">
                    <Multiple>Y</Multiple>
                    <Filters>
                        <if>/^(?!lo0$).*/</if>
                    </Filters>
                    <AllowDynamic>Y</AllowDynamic>
                </interface>
                <direction type="OptionField">
                    <Required>Y</Required>
                    <Default>in</Default>
                    <OptionValues>
                        <in>In</in>
                        <out>Out</out>
                    </OptionValues>
                </direction>
                <ipprotocol type="OptionField">
                    <Required>Y</Required>
                    <Default>inet</Default>
                    <OptionValues>
                        <inet>IPv4</inet>
                        <inet6>IPv6</inet6>
                        <inet46>IPv4+IPv6</inet46>
                    </OptionValues>
                </ipprotocol>
                <protocol type="ProtocolField">
                    <Required>Y</Required>
                    <Default>any</Default>
                    <AddOptions>
                        <opt1 value='TCP/UDP'>TCP/UDP</opt1>
                    </AddOptions>
                </protocol>  
                <icmp_type type="OptionField">
                    <OptionValues>
                        <any value="">Any</any>
                        <echoreq>Echo Request</echoreq>
                        <echorep>Echo Reply</echorep>
                        <unreach>Destination Unreachable</unreach>
                        <squench>Source Quench (Deprecated)</squench>
                        <redir>Redirect</redir>
                        <althost>Alternate Host Address (Deprecated)</althost>
                        <routeradv>Router Advertisement</routeradv>
                        <routersol>Router Solicitation</routersol>
                        <timex>Time Exceeded</timex>
                        <paramprob>Parameter Problem</paramprob>
                        <timereq>Timestamp</timereq>
                        <timerep>Timestamp Reply</timerep>
                        <inforeq>Information Request (Deprecated)</inforeq>
                        <inforep>Information Reply (Deprecated)</inforep>
                        <maskreq>Address Mask Request (Deprecated)</maskreq>
                        <maskrep>Address Mask Reply (Deprecated)</maskrep>
                    </OptionValues>
                </icmp_type>
                <icmp6_type type="OptionField">
                    <OptionValues>
                        <any value="">Any</any>
                        <unreach>Destination unreachable</unreach>
                        <toobig>Packet too big</toobig>
                        <timex>Time exceeded</timex>
                        <paramprob>Invalid IPv6 header</paramprob>
                        <echoreq>Echo service request</echoreq>
                        <echorep>Echo service reply</echorep>
                        <groupqry>Group membership query</groupqry>
                        <listqry>Multicast listener query</listqry>
                        <grouprep>Group membership report</grouprep>
                        <listenrep>Multicast listener report</listenrep>
                        <groupterm>Group membership termination</groupterm>
                        <listendone>Multicast listener done</listendone>
                        <routersol>Router solicitation</routersol>
                        <routeradv>Router advertisement</routeradv>
                        <neighbrsol>Neighbor solicitation</neighbrsol>
                        <neighbradv>Neighbor advertisement</neighbradv>
                        <redir>Shorter route exists</redir>
                        <routrrenum>Route renumbering</routrrenum>
                        <fqdnreq>FQDN query</fqdnreq>
                        <niqry>Node information query</niqry>
                        <wrureq>Who-are-you request</wrureq>
                        <fqdnrep>FQDN reply</fqdnrep>
                        <nirep>Node information reply</nirep>
                        <wrurep>Who-are-you reply</wrurep>
                        <mtraceresp>mtrace response</mtraceresp>
                        <mtrace>mtrace messages</mtrace>
                    </OptionValues>
                </icmp6_type>
                <source_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </source_not>
                <source_net type="NetworkAliasField">
                    <Required>Y</Required>
                    <Default>any</Default>
                </source_net>
                <source_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </source_port>
                <destination_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </destination_not>
                <destination_net type="NetworkAliasField">
                    <Default>any</Default>
                    <Required>Y</Required>
                </destination_net>
                <destination_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </destination_port>
                <log type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </log>
                <categories type="ModelRelationField">
                    <Model>
                        <rulesets>
                            <source>OPNsense.Firewall.Category</source>
                            <items>categories.category</items>
                            <display>name</display>
                        </rulesets>
                    </Model>
                    <Multiple>Y</Multiple>
                    <ValidationMessage>Related category not found.</ValidationMessage>
                </categories>
                <description type="DescriptionField"/>
                <no_xmlrpc_sync type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </no_xmlrpc_sync>
                <schedule type=".\ScheduleField"/>
                <gateway type="JsonKeyValueStoreField">
                    <ConfigdPopulateAct>interface gateways list -g</ConfigdPopulateAct>
                    <ValidationMessage>Specify a valid gateway from the list matching the networks ip protocol.</ValidationMessage>
                </gateway>
                <traffic_shaping type="ModelRelationField">
                    <Model>
                        <pipes>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>pipes.pipe</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </pipes>
                        <queues>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>queues.queue</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </queues>
                    </Model>
                    <ValidationMessage>Related pipe or queue not found</ValidationMessage>
                </traffic_shaping>
                <traffic_shaping_reverse type="ModelRelationField">
                    <Model>
                        <pipes>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>pipes.pipe</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </pipes>
                        <queues>
                            <source>OPNsense.TrafficShaper.TrafficShaper</source>
                            <items>queues.queue</items>
                            <display>description</display>
                            <filters>
                                <description>/(.){1,255}/</description>
                            </filters>
                        </queues>
                    </Model>
                    <ValidationMessage>Related pipe or queue not found</ValidationMessage>
                </traffic_shaping_reverse>
                <allow_options type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </allow_options>
                <reply_to type="JsonKeyValueStoreField">
                    <ConfigdPopulateAct>interface gateways list</ConfigdPopulateAct>
                    <ValidationMessage>Specify a valid gateway from the list matching the networks ip protocol.</ValidationMessage>
                </reply_to>
                <set_priority_all type="OptionField">
                    <BlankDesc>Keep current priority</BlankDesc>
                    <OptionValues>
                        <opt1 value="1">Background (1, lowest)</opt1>
                        <opt0 value="0">Best Effort (0, default)</opt0>
                        <opt2 value="2">Excellent Effort (2)</opt2>
                        <opt3 value="3">Critical Applications (3)</opt3>
                        <opt4 value="4">Video (4)</opt4>
                        <opt5 value="5">Voice (5)</opt5>
                        <opt6 value="6">Internetwork Control (6)</opt6>
                        <opt7 value="7">Network Control (7, highest)</opt7>
                    </OptionValues>
                </set_priority_all>
                <set_priority_low type="OptionField">
                    <BlankDesc>Use main priority</BlankDesc>
                    <OptionValues>
                        <opt1 value="1">Background (1, lowest)</opt1>
                        <opt0 value="0">Best Effort (0, default)</opt0>
                        <opt2 value="2">Excellent Effort (2)</opt2>
                        <opt3 value="3">Critical Applications (3)</opt3>
                        <opt4 value="4">Video (4)</opt4>
                        <opt5 value="5">Voice (5)</opt5>
                        <opt6 value="6">Internetwork Control (6)</opt6>
                        <opt7 value="7">Network Control (7, highest)</opt7>
                    </OptionValues>
                </set_priority_low>
                <match_priority type="OptionField">
                    <BlankDesc>Any priority</BlankDesc>
                    <OptionValues>
                        <opt1 value="1">Background (1, lowest)</opt1>
                        <opt0 value="0">Best Effort (0, default)</opt0>
                        <opt2 value="2">Excellent Effort (2)</opt2>
                        <opt3 value="3">Critical Applications (3)</opt3>
                        <opt4 value="4">Video (4)</opt4>
                        <opt5 value="5">Voice (5)</opt5>
                        <opt6 value="6">Internetwork Control (6)</opt6>
                        <opt7 value="7">Network Control (7, highest)</opt7>
                    </OptionValues>
                </match_priority>
                <match_tos_dscp type=".\TosField"/>
                <set_tag type="TextField">
                    <Mask>/^([0-9a-zA-Z.,_\-]){0,512}$/u</Mask>
                </set_tag>
                <match_tag type="TextField">
                    <Mask>/^([0-9a-zA-Z.,_\-]){0,512}$/u</Mask>
                </match_tag>
                <max_states type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max_states>
                <max_source_nodes type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max_source_nodes>
                <max_established type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max_established>
                <max_source_states type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max_source_states>
                <max_new_connections type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </max_new_connections>
                <state_timeout type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                </state_timeout>
                <adaptive_timeouts_start type="IntegerField">
                    <MinimumValue>0</MinimumValue>
                </adaptive_timeouts_start>
                <adaptive_timeouts_end type="IntegerField">
                    <MinimumValue>0</MinimumValue>
                </adaptive_timeouts_end>
                <tcp_flags_set type="OptionField">
                    <Multiple>Y</Multiple>
                    <OptionValues>
                        <syn>syn</syn>
                        <ack>ack</ack>
                        <fin>fin</fin>
                        <rst>rst</rst>
                        <psh>psh</psh>
                        <urg>urg</urg>
                        <ece>ece</ece>
                        <cwr>cwr</cwr>
                    </OptionValues>
                </tcp_flags_set>
                <tcp_flags_out_of type="OptionField">
                    <Multiple>Y</Multiple>
                    <OptionValues>
                        <syn>syn</syn>
                        <ack>ack</ack>
                        <fin>fin</fin>
                        <rst>rst</rst>
                        <psh>psh</psh>
                        <urg>urg</urg>
                        <ece>ece</ece>
                        <cwr>cwr</cwr>
                    </OptionValues>
                </tcp_flags_out_of>
                <source_os type="JsonKeyValueStoreField">
                    <ConfigdPopulateAct>filter list osfp json</ConfigdPopulateAct>
                    <ValidationMessage>Specify a valid OS Type.</ValidationMessage>
                </source_os>
                <no_pfsync type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </no_pfsync>
                <state_type type="OptionField">
                    <Required>Y</Required>
                    <Default>keep_state</Default>
                    <OptionValues>
                        <keep_state>Keep State</keep_state>
                        <sloppy_state>Sloppy State</sloppy_state>
                        <modulate_state>Modulate State</modulate_state>
                        <synproxy_state>Synproxy State</synproxy_state>
                        <none>None</none>
                    </OptionValues>
                </state_type>
                <state_policy type="OptionField">
                    <BlankDesc>default</BlankDesc>
                    <OptionValues>
                        <if-bound>Bind states to interface</if-bound>
                        <floating>Floating states</floating>
                    </OptionValues>
                </state_policy>
                <filter_rule type="TextField"/>
            </rule>
        </firewallrules>
        <outbound>
            <mode type="TextField"/>
            <rule type=".\SourceNatRuleField">
                <enabled type="BooleanField">
                    <Default>1</Default>
                    <Required>Y</Required>
                </enabled>
                <sequence type="IntegerField">
                    <MinimumValue>1</MinimumValue>
                    <MaximumValue>99999</MaximumValue>
                    <ValidationMessage>provide a valid sequence for sorting</ValidationMessage>
                    <Required>Y</Required>
                    <Default>1</Default>
                </sequence>
                <nonat type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </nonat>
                <interface type="InterfaceField">
                    <Required>Y</Required>
                    <Default>wan</Default>
                    <AllowDynamic>Y</AllowDynamic>
                </interface>
                <ipprotocol type="OptionField">
                    <Required>Y</Required>
                    <Default>inet</Default>
                    <OptionValues>
                        <inet>IPv4</inet>
                        <inet6>IPv6</inet6>
                    </OptionValues>
                </ipprotocol>
                <protocol type="ProtocolField">
                    <Required>Y</Required>
                    <Default>any</Default>
                    <AddOptions>
                        <opt1 value='TCP/UDP'>TCP/UDP</opt1>
                    </AddOptions>
                </protocol>
                <source_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </source_not>
                <source_net type="NetworkAliasField">
                    <Required>Y</Required>
                    <Default>any</Default>
                </source_net>
                <source_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </source_port>
                <destination_not type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </destination_not>
                <destination_net type="NetworkAliasField">
                    <Required>Y</Required>
                    <Default>any</Default>
                </destination_net>
                <destination_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                    <EnableAlias>Y</EnableAlias>
                    <ValidationMessage>Please specify a valid portnumber, name, alias or range</ValidationMessage>
                </destination_port>
                <target type="TranslationField"/>
                <target_port type="PortField">
                    <EnableWellKnown>Y</EnableWellKnown>
                    <EnableRanges>Y</EnableRanges>
                </target_port>
                <static_port type="BooleanField">
                    <Default>0</Default>
                </static_port>
                <log type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </log>
                <pool_options type="OptionField">
                    <BlankDesc>Default</BlankDesc>
                    <OptionValues>
                        <round_robin>Round Robin</round_robin>
                        <rr_sticky_addr>Round Robin with Sticky Address</rr_sticky_addr>
                        <random>Random</random>
                        <ra_sticky_addr>Random with Sticky Address</ra_sticky_addr>
                        <source_hash>Source Hash</source_hash>
                        <bitmask>Bitmask</bitmask>
                    </OptionValues>
                </pool_options>
                <source_hash_key type="TextField"/>
                <set_tag type="TextField"/>
                <match_tag type="TextField"/>
                <no_xmlrpc_sync type="BooleanField">
                    <Default>0</Default>
                    <Required>Y</Required>
                </no_xmlrpc_sync>
                <categories type="ModelRelationField">
                    <Model>
                        <rulesets>
                            <source>OPNsense.Firewall.Category</source>
                            <items>categories.category</items>
                            <display>name</display>
                        </rulesets>
                    </Model>
                    <Multiple>Y</Multiple>
                    <ValidationMessage>Related category not found.</ValidationMessage>
                </categories>
                <description type="DescriptionField"/>
            </rule>
        </outbound>
    </items>
</model>
